2025-03-26 22:05:53,471 - __main__ - INFO - Loading environment from: /Users/mitchie/Documents/LUNA/LUNA/.env.local
2025-03-26 22:05:53,472 - __main__ - INFO - Importing core components...
2025-03-26 22:05:53,553 - core.utility_registry - INFO - Registered utility: utils.generate.classify
2025-03-26 22:05:53,553 - core.utility_registry - INFO - Registered utility: utils.generate.extract_entities
2025-03-26 22:05:53,553 - core.utility_registry - INFO - Registered utility: utils.generate.generate
2025-03-26 22:05:53,553 - core.utility_registry - INFO - Registered utility: utils.request.confirm
2025-03-26 22:05:53,553 - core.utility_registry - INFO - Registered utility: utils.request.request
2025-03-26 22:05:53,553 - core.utility_registry - INFO - Registered utility: utils.request.select
2025-03-26 22:05:53,553 - core.utility_registry - INFO - Registered utility: utils.reply.end_workflow
2025-03-26 22:05:53,554 - core.utility_registry - INFO - Registered utility: utils.reply.format_reply
2025-03-26 22:05:53,554 - core.utility_registry - INFO - Registered utility: utils.reply.reply
2025-03-26 22:05:53,554 - __main__ - INFO - Initializing database...
2025-03-26 22:05:54,221 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Schema.IndexOrConstraintAlreadyExists} {category: SCHEMA} {title: `CREATE CONSTRAINT session_id IF NOT EXISTS FOR (e:SESSION) REQUIRE (e.id) IS UNIQUE` has no effect.} {description: `CONSTRAINT session_id_unique FOR (e:SESSION) REQUIRE (e.id) IS UNIQUE` already exists.} {position: None} for query: '\n            CREATE CONSTRAINT session_id IF NOT EXISTS \n            FOR (s:SESSION) REQUIRE s.id IS UNIQUE\n            '
2025-03-26 22:05:54,271 - main - INFO - Database schema initialized
2025-03-26 22:05:54,271 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Schema.IndexOrConstraintAlreadyExists} {category: SCHEMA} {title: `CREATE CONSTRAINT step_id IF NOT EXISTS FOR (e:STEP) REQUIRE (e.id) IS UNIQUE` has no effect.} {description: `CONSTRAINT step_id FOR (e:STEP) REQUIRE (e.id) IS UNIQUE` already exists.} {position: None} for query: '\n            CREATE CONSTRAINT step_id IF NOT EXISTS \n            FOR (s:STEP) REQUIRE s.id IS UNIQUE\n            '
2025-03-26 22:05:54,271 - __main__ - INFO - Database initialized successfully
2025-03-26 22:05:54,273 - __main__ - INFO - Starting Flask server...
 * Serving Flask app 'app'
 * Debug mode: on
2025-03-26 22:05:54,306 - werkzeug - INFO - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.0.12:5000
2025-03-26 22:05:54,306 - werkzeug - INFO - [33mPress CTRL+C to quit[0m
2025-03-26 22:05:54,306 - werkzeug - INFO -  * Restarting with stat
2025-03-26 22:05:54,401 - __main__ - INFO - Loading environment from: /Users/mitchie/Documents/LUNA/LUNA/.env.local
2025-03-26 22:05:54,402 - __main__ - INFO - Importing core components...
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.generate.classify
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.generate.extract_entities
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.generate.generate
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.request.confirm
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.request.request
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.request.select
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.reply.end_workflow
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.reply.format_reply
2025-03-26 22:05:54,462 - core.utility_registry - INFO - Registered utility: utils.reply.reply
2025-03-26 22:05:54,462 - __main__ - INFO - Initializing database...
2025-03-26 22:05:55,013 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Schema.IndexOrConstraintAlreadyExists} {category: SCHEMA} {title: `CREATE CONSTRAINT session_id IF NOT EXISTS FOR (e:SESSION) REQUIRE (e.id) IS UNIQUE` has no effect.} {description: `CONSTRAINT session_id_unique FOR (e:SESSION) REQUIRE (e.id) IS UNIQUE` already exists.} {position: None} for query: '\n            CREATE CONSTRAINT session_id IF NOT EXISTS \n            FOR (s:SESSION) REQUIRE s.id IS UNIQUE\n            '
2025-03-26 22:05:55,070 - main - INFO - Database schema initialized
2025-03-26 22:05:55,070 - neo4j.notifications - INFO - Received notification from DBMS server: {severity: INFORMATION} {code: Neo.ClientNotification.Schema.IndexOrConstraintAlreadyExists} {category: SCHEMA} {title: `CREATE CONSTRAINT step_id IF NOT EXISTS FOR (e:STEP) REQUIRE (e.id) IS UNIQUE` has no effect.} {description: `CONSTRAINT step_id FOR (e:STEP) REQUIRE (e.id) IS UNIQUE` already exists.} {position: None} for query: '\n            CREATE CONSTRAINT step_id IF NOT EXISTS \n            FOR (s:STEP) REQUIRE s.id IS UNIQUE\n            '
2025-03-26 22:05:55,070 - __main__ - INFO - Database initialized successfully
2025-03-26 22:05:55,072 - __main__ - INFO - Starting Flask server...
2025-03-26 22:05:55,090 - werkzeug - WARNING -  * Debugger is active!
2025-03-26 22:05:55,098 - werkzeug - INFO -  * Debugger PIN: 113-315-203
2025-03-26 22:05:57,471 - werkzeug - INFO - 192.168.0.12 - - [26/Mar/2025 22:05:57] "GET / HTTP/1.1" 200 -
2025-03-26 22:05:57,671 - core.graph_engine - INFO - Processing step: root
2025-03-26 22:05:57,671 - core.graph_engine - INFO - Getting details for step: root
2025-03-26 22:05:57,755 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: utility)} {position: line: 3, column: 26, offset: 67} for query: '\n                MATCH (s:STEP {id: $id})\n                RETURN s.utility as utility, s.input as input\n                '
2025-03-26 22:05:57,755 - core.graph_engine - INFO - Step root details: utility=None
2025-03-26 22:05:57,755 - core.graph_engine - INFO - Step root details: utility=None
2025-03-26 22:05:57,755 - core.graph_engine - INFO - Resolved inputs for root: {}
2025-03-26 22:05:57,755 - core.graph_engine - WARNING - Step root has no utility function, marking as complete
2025-03-26 22:05:58,012 - core.graph_engine - INFO - Completed steps for path evaluation: ['root']
2025-03-26 22:05:58,092 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: priority)} {position: line: 4, column: 54, offset: 203} for query: '\n                    MATCH (s:STEP {id: $id})-[r:NEXT]->(target:STEP)\n                    RETURN target.id as target_id, r.conditions as conditions, \n                           r.operator as operator, r.priority as priority\n                    ORDER BY r.priority ASC\n                    '
2025-03-26 22:05:58,092 - core.graph_engine - INFO - Evaluating relationship from root to get-question: {'target_step': 'get-question', 'conditions': [], 'operator': 'AND', 'priority': 100}
2025-03-26 22:05:58,092 - core.graph_engine - INFO - Conditions met for root -> get-question: True
2025-03-26 22:05:58,092 - core.graph_engine - INFO - Next steps to activate: [{'step_id': 'get-question', 'priority': 100, 'source_step': 'root'}]
2025-03-26 22:05:58,218 - core.graph_engine - INFO - Adding new step to workflow: get-question
2025-03-26 22:05:58,218 - core.graph_engine - INFO - *** LOOP DEBUG *** Workflow state after update: {'root': 'complete', 'get-question': 'active'}
2025-03-26 22:05:58,674 - core.graph_engine - INFO - Processing step: get-question
2025-03-26 22:05:58,694 - core.graph_engine - INFO - Getting details for step: get-question
2025-03-26 22:05:58,856 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: utility)} {position: line: 3, column: 26, offset: 67} for query: '\n                MATCH (s:STEP {id: $id})\n                RETURN s.utility as utility, s.input as input\n                '
2025-03-26 22:05:58,856 - core.graph_engine - INFO - Step get-question details: utility=None
2025-03-26 22:05:58,856 - core.graph_engine - INFO - Step get-question details: utility=None
2025-03-26 22:05:58,857 - core.graph_engine - INFO - Input data for get-question: {'query': '@{SESSION_ID}.generate-answer.followup |GM! How can I help you today?'}
2025-03-26 22:05:58,858 - core.graph_engine - INFO - Resolved inputs for get-question: {'query': 'GM! How can I help you today?'}
2025-03-26 22:05:58,858 - core.graph_engine - WARNING - Step get-question has no utility function, marking as complete
2025-03-26 22:05:59,148 - core.graph_engine - INFO - Completed steps for path evaluation: ['root', 'get-question']
2025-03-26 22:05:59,216 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: priority)} {position: line: 4, column: 54, offset: 203} for query: '\n                    MATCH (s:STEP {id: $id})-[r:NEXT]->(target:STEP)\n                    RETURN target.id as target_id, r.conditions as conditions, \n                           r.operator as operator, r.priority as priority\n                    ORDER BY r.priority ASC\n                    '
2025-03-26 22:05:59,216 - core.graph_engine - INFO - Evaluating relationship from root to get-question: {'target_step': 'get-question', 'conditions': [], 'operator': 'AND', 'priority': 100}
2025-03-26 22:05:59,216 - core.graph_engine - INFO - Conditions met for root -> get-question: True
2025-03-26 22:05:59,306 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: priority)} {position: line: 4, column: 54, offset: 203} for query: '\n                    MATCH (s:STEP {id: $id})-[r:NEXT]->(target:STEP)\n                    RETURN target.id as target_id, r.conditions as conditions, \n                           r.operator as operator, r.priority as priority\n                    ORDER BY r.priority ASC\n                    '
2025-03-26 22:05:59,306 - core.graph_engine - INFO - Evaluating relationship from get-question to generate-answer: {'target_step': 'generate-answer', 'conditions': [], 'operator': 'AND', 'priority': 100}
2025-03-26 22:05:59,306 - core.graph_engine - INFO - Conditions met for get-question -> generate-answer: True
2025-03-26 22:05:59,306 - core.graph_engine - INFO - Next steps to activate: [{'step_id': 'get-question', 'priority': 100, 'source_step': 'root'}, {'step_id': 'generate-answer', 'priority': 100, 'source_step': 'get-question'}]
2025-03-26 22:05:59,407 - core.graph_engine - INFO - Adding new step to workflow: generate-answer
2025-03-26 22:05:59,407 - core.graph_engine - INFO - *** LOOP DEBUG *** Workflow state after update: {'root': 'complete', 'get-question': 'complete', 'generate-answer': 'active'}
2025-03-26 22:05:59,642 - core.graph_engine - INFO - Processing step: generate-answer
2025-03-26 22:05:59,642 - core.graph_engine - INFO - Getting details for step: generate-answer
2025-03-26 22:05:59,701 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: utility)} {position: line: 3, column: 26, offset: 67} for query: '\n                MATCH (s:STEP {id: $id})\n                RETURN s.utility as utility, s.input as input\n                '
2025-03-26 22:05:59,702 - core.graph_engine - INFO - Step generate-answer details: utility=None
2025-03-26 22:05:59,702 - core.graph_engine - INFO - Step generate-answer details: utility=None
2025-03-26 22:05:59,702 - core.graph_engine - INFO - get-question output: {}
2025-03-26 22:05:59,702 - core.graph_engine - INFO - get-question step doesn't have a response, marking as awaiting input
2025-03-26 22:06:00,157 - werkzeug - INFO - 192.168.0.12 - - [26/Mar/2025 22:06:00] "POST /api/session HTTP/1.1" 200 -
2025-03-26 22:06:06,056 - core.graph_engine - INFO - Handling user input for session 7a499431-89ff-4067-8ea7-246bbe3e5177: Tell me about cheese
2025-03-26 22:06:06,110 - core.graph_engine - INFO - Found awaiting step: get-question
2025-03-26 22:06:06,379 - core.graph_engine - INFO - Completed steps for path evaluation: ['root', 'get-question']
2025-03-26 22:06:06,435 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: priority)} {position: line: 4, column: 54, offset: 203} for query: '\n                    MATCH (s:STEP {id: $id})-[r:NEXT]->(target:STEP)\n                    RETURN target.id as target_id, r.conditions as conditions, \n                           r.operator as operator, r.priority as priority\n                    ORDER BY r.priority ASC\n                    '
2025-03-26 22:06:06,436 - core.graph_engine - INFO - Evaluating relationship from root to get-question: {'target_step': 'get-question', 'conditions': [], 'operator': 'AND', 'priority': 100}
2025-03-26 22:06:06,436 - core.graph_engine - INFO - Conditions met for root -> get-question: True
2025-03-26 22:06:06,498 - neo4j.notifications - WARNING - Received notification from DBMS server: {severity: WARNING} {code: Neo.ClientNotification.Statement.UnknownPropertyKeyWarning} {category: UNRECOGNIZED} {title: The provided property key is not in the database} {description: One of the property names in your query is not available in the database, make sure you didn't misspell it or that the label is available when you run this statement in your application (the missing property name is: priority)} {position: line: 4, column: 54, offset: 203} for query: '\n                    MATCH (s:STEP {id: $id})-[r:NEXT]->(target:STEP)\n                    RETURN target.id as target_id, r.conditions as conditions, \n                           r.operator as operator, r.priority as priority\n                    ORDER BY r.priority ASC\n                    '
2025-03-26 22:06:06,498 - core.graph_engine - INFO - Evaluating relationship from get-question to generate-answer: {'target_step': 'generate-answer', 'conditions': [], 'operator': 'AND', 'priority': 100}
2025-03-26 22:06:06,498 - core.graph_engine - INFO - Conditions met for get-question -> generate-answer: True
2025-03-26 22:06:06,498 - core.graph_engine - INFO - Next steps to activate: [{'step_id': 'get-question', 'priority': 100, 'source_step': 'root'}, {'step_id': 'generate-answer', 'priority': 100, 'source_step': 'get-question'}]
2025-03-26 22:06:06,604 - core.graph_engine - INFO - Activating pending step: generate-answer
2025-03-26 22:06:06,604 - core.graph_engine - INFO - *** LOOP DEBUG *** Workflow state after update: {'root': 'complete', 'get-question': 'complete', 'generate-answer': 'active'}
2025-03-26 22:06:06,761 - core.graph_engine - INFO - Found 1 active steps after input: ['generate-answer']
2025-03-26 22:06:06,817 - __main__ - INFO - Final workflow state after processing: {'root': {'status': 'complete', 'error': ''}, 'get-question': {'status': 'complete', 'error': ''}, 'generate-answer': {'status': 'active', 'error': ''}}
2025-03-26 22:06:07,010 - werkzeug - INFO - 192.168.0.12 - - [26/Mar/2025 22:06:07] "POST /api/session/7a499431-89ff-4067-8ea7-246bbe3e5177/message HTTP/1.1" 200 -
